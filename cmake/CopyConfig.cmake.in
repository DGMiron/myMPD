# Install startup script
if((EXISTS "/etc/debian_version") and (EXISTS "/usr/lib/systemd/system"))
  #Install systemd unit
  message("-- Installing: $env{DESTDIR}/lib/systemd/system/mympd.service")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_CURRENT_BINARY_DIR@/contrib/initscripts/mympd.service" "$env{DESTDIR}/lib/systemd/system/mympd.service")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}/lib/systemd/system/mympd.service")
elseif(EXISTS "/usr/lib/systemd/system")
  #Install systemd unit
  message("-- Installing: $env{DESTDIR}/usr/lib/systemd/system/mympd.service")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_CURRENT_BINARY_DIR@/contrib/initscripts/mympd.service" "$env{DESTDIR}/usr/lib/systemd/system/mympd.service")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}/usr/lib/systemd/system/mympd.service")
elseif(EXISTS "/lib/systemd/system")
  #Install systemd unit
  message("-- Installing: $env{DESTDIR}/lib/systemd/system/mympd.service")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_CURRENT_BINARY_DIR@/contrib/initscripts/mympd.service" "$env{DESTDIR}/lib/systemd/system/mympd.service")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}/lib/systemd/system/mympd.service")
elseif(EXISTS "/sbin/openrc-run")
  #Install openrc script
  message("-- Installing: $env{DESTDIR}/etc/init.d/mympd")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_CURRENT_BINARY_DIR@/contrib/initscripts/mympd.openrc" "$env{DESTDIR}/etc/init.d/mympd")
elseif(EXISTS "/etc/init.d")
  #Install sysVinit script
  message("-- Installing: $env{DESTDIR}/etc/init.d/mympd")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_CURRENT_BINARY_DIR@/contrib/initscripts/mympd.sysVinit" "$env{DESTDIR}/etc/init.d/mympd")
endif()

# Install debian specific files
if(EXISTS "/etc/debian_version")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_SOURCE_DIR@/contrib/packaging/debian/copyright" "$env{DESTDIR}@CMAKE_INSTALL_FULL_DATAROOTDIR@/doc/mympd/copyright")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}@CMAKE_INSTALL_FULL_DATAROOTDIR@/doc/mympd/copyright")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_SOURCE_DIR@/contrib/packaging/debian/changelog" "$env{DESTDIR}@CMAKE_INSTALL_FULL_DATAROOTDIR@/doc/mympd/changelog.Debian")
  execute_process(COMMAND gzip -n -f -v -9 "$env{DESTDIR}@CMAKE_INSTALL_FULL_DATAROOTDIR@/doc/mympd/changelog.Debian")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}@CMAKE_INSTALL_FULL_DATAROOTDIR@/doc/mympd/changelog.Debian.gz")
endif()

# Install and compress manpages
if("@MYMPD_MANPAGES@" STREQUAL "ON")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_SOURCE_DIR@/contrib/man/mympd.1" "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd.1")
  execute_process(COMMAND @CMAKE_COMMAND@ -E copy "@CMAKE_SOURCE_DIR@/contrib/man/mympd.1" "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd-script.1")
  execute_process(COMMAND gzip -n -f -v -9 "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd.1")
  execute_process(COMMAND gzip -n -f -v -9 "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd-script.1")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd.1.gz")
  execute_process(COMMAND chmod 644 "$env{DESTDIR}@CMAKE_INSTALL_FULL_MANDIR@/man1/mympd-script.1.gz")
endif()
